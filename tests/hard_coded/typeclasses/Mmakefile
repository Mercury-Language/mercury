#-----------------------------------------------------------------------------#

main_target: check

include ../../Mmake.common
-include ../../Mmake.params

#-----------------------------------------------------------------------------#

PROGS=	\
	arbitrary_constraint_class \
	arbitrary_constraint_pred_2 \
	arbitrary_constraint_pred_1 \
	constrained_lambda \
	extract_typeinfo \
	exist_disjunction \
	existential_type_classes \
	existential_data_types \
	existential_data_types_regr_test \
	existential_rtti \
	existential_type_switch \
	extra_typeinfo \
	func_default_mode_bug \
	ho_map \
	implied_instance \
	implied_instance_multi_constraint \
	implied_instance_missing_constraint \
	implied_instance_poly \
	impure_methods \
	instance_clauses \
	instance_unconstrained_tvar \
	instance_unconstrained_tvar_dup \
	instance_unconstrained_tvar_type_spec \
	inference_test \
	inference_test_2 \
	intermod_typeclass_bug \
	lambda_multi_constraint_same_tvar \
	mode_decl_order_bug \
	module_test \
	multi_constraint_diff_tvar \
	multi_constraint_same_tvar \
	multi_moded \
	multi_parameter \
	multi_parameter_bug \
	nondet_class_method \
	operator_classname \
	record_syntax \
	recursive_instance_1 \
	reordered_existential_constraint \
	superclass_bug \
	superclass_bug2 \
	superclass_bug3 \
	superclass_call \
	test_default_func_mode \
	tuple_instance \
	typeclass_exist_method \
	typeclass_exist_method_2 \
	typeclass_order_bug \
	typeclass_order_bug2 \
	typeclass_order_bug3 \
	typeclass_test_5 \
	typeclass_test_6 \
	type_spec \
	unbound_tvar \
	unqualified_method \
	use_abstract_instance

# The following tests are not enabled:
#	complicated_constraint --
#		because we don't support that feature yet

MCFLAGS-abstract_instance = --infer-all
MCFLAGS-existential_type_classes = --infer-all
MCFLAGS-extra_typeinfo = --optimize-higher-order --no-type-specialization \
				--body-typeinfo-liveness
MCFLAGS-inference_test = --infer-all
MCFLAGS-inference_test_2 = --infer-all
MCFLAGS-intermod_typeclass_bug = --intermodule-optimization
MCFLAGS-intermod_typeclass_bug2 = --intermodule-optimization
MCFLAGS-lambda_multi_constraint_same_tvar = --infer-all

	# Check that the exported specialized versions are still created.
MCFLAGS-type_spec_2 = --no-user-guided-type-specialization
MCFLAGS-unbound_tvar = --no-user-guided-type-specialisation
MCFLAGS-unqualified_method = --intermodule-optimization
MCFLAGS-unqualified_method2 = --intermodule-optimization
MCFLAGS-unqualified_method3 = --intermodule-optimization
MCFLAGS-module_test_m1 = --infer-all
MCFLAGS-module_test_m2 = --infer-all
MCFLAGS-module_test = --infer-all

#-----------------------------------------------------------------------------#

DEPS=	$(PROGS:%=%.dep)
DEPENDS=$(PROGS:%=%.depend)
OUTS=	$(PROGS:%=%.out)
RESS=	$(PROGS:%=%.res)

#-----------------------------------------------------------------------------#

dep:	$(DEPS)

depend:	$(DEPENDS)

check:	$(OUTS) $(RESS)

all:	$(PROGS)

#-----------------------------------------------------------------------------#
